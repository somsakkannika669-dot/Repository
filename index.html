<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ร้านค้าออนไลน์</title>
</head>
<body>

<h1>สินค้า</h1>
<div id="products"></div>

<hr>

<h2>ตะกร้า</h2>
<div id="cart"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "myshop-cd2cb.firebaseapp.com",
  projectId: "myshop-cd2cb",
  storageBucket: "myshop-cd2cb.appspot.com",
  messagingSenderId: "308991984475",
  appId: "1:308991984475:web:xxxxxxxxxxxx"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let cart = [];

// โหลดสินค้า
const querySnapshot = await getDocs(collection(db, "products"));
const productDiv = document.getElementById("products");

querySnapshot.forEach((doc) => {
  const data = doc.data();

  const div = document.createElement("div");

  div.innerHTML = `
    <h3>${data.name}</h3>
    <p>${data.price} บาท</p>
    <button onclick="addToCart('${data.name}', ${data.price})">
      เพิ่มตะกร้า
    </button>
    <hr>
  `;

  productDiv.appendChild(div);
});

// เพิ่มสินค้าเข้าตะกร้า
window.addToCart = function(name, price) {
  cart.push({ name, price });
  renderCart();
};

// แสดงตะกร้า
function renderCart() {
  const cartDiv = document.getElementById("cart");
  cartDiv.innerHTML = "";

  let total = 0;

  cart.forEach((item) => {
    total += item.price;

    const p = document.createElement("p");
    p.innerText = item.name + " - " + item.price + " บาท";
    cartDiv.appendChild(p);
  });

  const totalText = document.createElement("h3");
  totalText.innerText = "รวมทั้งหมด: " + total + " บาท";
  cartDiv.appendChild(totalText);
}
</script>

</body>
</html>
